{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Manage Diseases</title>
    <link rel="stylesheet" href="{% static 'css/admin_diseases.css' %}" />
  </head>
  <body>
    <div class="layout disease-admin">
      {% include 'sidder_part.html' %}
      <header>Custom Admin â€“ Manage Diseases</header>

      <div class="container">
        <div class="forms">
          <!-- Disease Form -->
          <div class="card">
            <h2>Add Disease</h2>
            <form method="post">
              {% csrf_token %}
              {{ disease_form.as_p }}
              {% if disease_form.errors %}
                <div class="errorlist">{{ disease_form.errors }}</div>
              {% endif %}
              <button type="submit" name="disease_submit" class="btn">Add Disease</button>
            </form>
          </div>

          <!-- Doctor-Disease Assignment Form -->
          <div class="card">
            <h2>Assign Disease to Doctor</h2>
            <form method="post">
              {% csrf_token %}
              {{ assignment_form.as_p }}
              {% if assignment_form.errors %}
                <div class="errorlist">{{ assignment_form.errors }}</div>
              {% endif %}
              <button type="submit" name="assignment_submit" class="btn">Assign Disease</button>
            </form>
          </div>
        </div>

        <!-- Disease List -->
        <h2>All Diseases</h2>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Disease</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            {% for d in diseases %}
            <tr>
              <td>{{ d.id }}</td>
              <td>{{ d.name }}</td>
              <td>{{ d.description }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="3">No diseases found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <!-- Assignments List -->
        <h2>Doctor-Disease Assignments</h2>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Doctor</th>
              <th>Disease</th>
            </tr>
          </thead>
          <tbody>
            {% if latest_id %}
            <tr>
              <td colspan="3">
                <strong>Latest inserted ID:</strong> {{ latest_id }}
              </td>
            </tr>
            {% endif %}
            {% for a in assignments %}
            <tr>
              <td>{{ a.id }}</td>
              <td>{{ a.doctor.full_name }}</td>
              <td>{{ a.disease.name }}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="3">No assignments found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
